{% extends "base.html" %}
{# Hergebruikt base.html structuur #}

{% block content %}
<div class="auth-container">
    
    <h1>Inloggen</h1>
    
    <form class="auth-form" method="post" action="{{ url_for('main.login') }}">
        {# Formulier verstuurt data via POST naar /login #}
        
        {{ form.hidden_tag() }}
        {# CSRF beveiliging: alleen echte formulieren van deze site werken #}
        
        <div class="form-group">
            {{ form.email.label }}
            {# Label "Email" #}
            {{ form.email(class="form-control") }}
            {# Email invoerveld #}
            {% if form.email.errors %}
                <div class="form-errors">{{ form.email.errors[0] }}</div>
                {# Foutmelding: email is verplicht of ongeldig #}
            {% endif %}
        </div>
        
        <div class="form-group">
            {{ form.password.label }}
            {# Label "Wachtwoord" #}
            {{ form.password(class="form-control") }}
            {# Wachtwoord invoerveld (verborgen tekst) #}
            {% if form.password.errors %}
                <div class="form-errors">{{ form.password.errors[0] }}</div>
                {# Foutmelding: wachtwoord is verplicht #}
            {% endif %}
        </div>
        
        <div class="form-group">
            {{ form.remember_me() }}
            {{ form.remember_me.label }}
            {# Checkbox "Onthoud mij" om ingelogd te blijven #}
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn-submit">Inloggen</button>
        </div>
    </form>
    
    <div class="auth-links">
        <p>Nog geen account? <a href="{{ url_for('main.registreer') }}" class="link-primary">Maak er nu Ã©Ã©n aan</a></p>
        <p><a href="{{ url_for('main.wachtwoord_vergeten') }}" class="link-secondary">Wachtwoord vergeten?</a></p>
    </div>
</div>
{% endblock %}

{% block footer %}
{% endblock %}

{% block js %}
{% endblock %}

# In de terminal (vanuit projectroot met venv actief):
python3 << 'PY'
from app import create_app, db
from app.models import Abonnement, Betaling

app = create_app()
with app.app_context():
    # Maak test-abonnement
    ab = Abonnement(
        naam="Premium Plan",
        prijs=29.99,
        looptijd_maanden=12,
        actief=True
    )
    db.session.add(ab)
    db.session.commit()
    print(f"âœ… Abonnement aangemaakt: {ab.naam} (ID: {ab.abonnement_id})")

    # Maak test-betaling gekoppeld aan abonnement
    b = Betaling(
        abonnement_id=ab.abonnement_id,
        bedrag=29.99,
        status="betaald"
    )
    db.session.add(b)
    db.session.commit()
    print(f"âœ… Betaling aangemaakt: â‚¬{b.bedrag} (ID: {b.id})")

    # Test de relatie: haal via abonnement.betalingen
    abonnement = Abonnement.query.first()
    print(f"\nðŸ“‹ Abonnement: {abonnement.naam}")
    print(f"   Betalingen voor dit abonnement:")
    for betaling in abonnement.betalingen:
        print(f"   - â‚¬{betaling.bedrag} ({betaling.status})")
PY



